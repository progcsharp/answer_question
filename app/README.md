# Question-Answer API

FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞–º–∏ –∏ –æ—Ç–≤–µ—Ç–∞–º–∏ —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL.

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ .env

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –ø–∞–ø–∫–µ `app` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:

```bash
DATABASE_URL=postgresql+asyncpg://myuser:mypassword@postgres:5432/mydatabase
DB_HOST=postgres
DB_PORT=5432
DB_NAME=mydatabase
DB_USER=myuser
DB_PASSWORD=mypassword
```

#### 2. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

–ü–µ—Ä–µ–¥–∞–π—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É .env —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥ `--env-file`:

```bash
# –ò–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
docker-compose --env-file app/.env up -d
```

#### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
- **API**: http://localhost:8080
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: http://localhost:8080/docs
- **Health check**: http://localhost:8080/health

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ó–∞–ø—É—Å–∫ –±–µ–∑ Docker (–ª–æ–∫–∞–ª—å–Ω–æ)

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd app
pip install -r requirements.txt
```

#### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω PostgreSQL, –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ `DATABASE_URL` –≤ `.env` –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π:

```bash
# –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ PostgreSQL
DATABASE_URL=postgresql+asyncpg://username:password@localhost:5432/database_name
```

#### 3. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ uvicorn

```bash
cd app
uvicorn app:app --host 0.0.0.0 --port 8080 --reload
```

## üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
cd app
pip install -r requirements.txt
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
python -m pytest tests/ -v

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
python -m pytest tests/test_simple.py::test_app_structure -v

# –° –≤—ã–≤–æ–¥–æ–º print
python -m pytest tests/ -v -s

# –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
python run_tests.py
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
question_test/
‚îú‚îÄ‚îÄ README.md                           # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ docker-compose.yml                  # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ nginx.conf                          # Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ app/                                # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

```
app/
‚îú‚îÄ‚îÄ app.py                              # –ì–ª–∞–≤–Ω–æ–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ requirements.txt                     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ pytest.ini                          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest
‚îú‚îÄ‚îÄ run_tests.py                        # –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ README.md                           # –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è app
‚îú‚îÄ‚îÄ Dockerfile                          # Docker –æ–±—Ä–∞–∑ –¥–ª—è FastAPI
‚îú‚îÄ‚îÄ alembic/                            # –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ env.py                          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic
‚îÇ   ‚îú‚îÄ‚îÄ script.py.mako                  # –®–∞–±–ª–æ–Ω –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ README                          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Alembic
‚îÇ   ‚îî‚îÄ‚îÄ versions/                       # –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ       ‚îî‚îÄ‚îÄ 4f66f74a7d1f_initial_migration.py
‚îú‚îÄ‚îÄ üìÅ db/                                 # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py                     # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ config.py                       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ connection.py                   # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ engine.py                       # –î–≤–∏–∂–æ–∫ –ë–î –∏ —Å–µ—Å—Å–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ enums.py                        # –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ models.py                       # –ú–æ–¥–µ–ª–∏ SQLAlchemy
‚îÇ   ‚îú‚îÄ‚îÄ utils.py                        # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ handler/                        # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ë–î
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py                 # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îÇ       ‚îú‚îÄ‚îÄ create.py                   # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π
‚îÇ       ‚îú‚îÄ‚îÄ delete.py                   # –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π
‚îÇ       ‚îú‚îÄ‚îÄ get.py                      # –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π
‚îÇ       ‚îî‚îÄ‚îÄ update.py                   # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π
‚îú‚îÄ‚îÄ exception/                          # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py                     # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ database.py                     # –ò—Å–∫–ª—é—á–µ–Ω–∏—è –ë–î
‚îú‚îÄ‚îÄ routers/                            # API —Ä–æ—É—Ç–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py                     # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ questions.py                    # –†–æ—É—Ç–µ—Ä –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ answer.py                       # –†–æ—É—Ç–µ—Ä –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ shemas/                             # Pydantic —Å—Ö–µ–º—ã (–ø—Ä–∏–º–µ—á–∞–Ω–∏–µ: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "schemas")
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py                     # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ questions.py                    # –°—Ö–µ–º—ã –≤–æ–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ answer.py                       # –°—Ö–µ–º—ã –æ—Ç–≤–µ—Ç–æ–≤
‚îî‚îÄ‚îÄ tests/                              # –¢–µ—Å—Ç—ã
    ‚îú‚îÄ‚îÄ __init__.py                     # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
    ‚îú‚îÄ‚îÄ conftest.py                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest
    ‚îú‚îÄ‚îÄ test_simple.py                  # –ü—Ä–æ—Å—Ç—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    ‚îî‚îÄ‚îÄ test_validation.py              # –¢–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```

## üîß API Endpoints

### Questions
- `GET /questions/` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã
- `GET /questions/{id}` - –ü–æ–ª—É—á–∏—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ ID
- `POST /questions/` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å
- `DELETE /questions/{id}` - –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å
- `POST /questions/{id}/answers/` - –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç –∫ –≤–æ–ø—Ä–æ—Å—É

### Answers
- `GET /answers/{id}` - –ü–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –ø–æ ID
- `DELETE /answers/{id}` - –£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç

### Health
- `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞

## üê≥ Docker –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫
docker-compose --env-file app/.env up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞
docker-compose --env-file app/.env up -d --build

# –û—á–∏—Å—Ç–∫–∞
docker-compose down -v --remove-orphans
```
